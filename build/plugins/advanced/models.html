
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
	<meta charset="utf-8" />
	<title>Models - Blocks Docs</title>
	<link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
	<link rel="stylesheet" href="../../_static/css/docs.css" type="text/css" />
</head>

<body>
	<div class="sidebar">
		<div class="content">
			<h1>Blocks Docs</h1>

			<nav class="nav">
				<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Blocks Docs Home</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installing and Updating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">System Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../templating/index.html">Templating</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Plugin Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">The Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../db/index.html">Working with the Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../components/index.html">Adding New Components</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Advanced Topics</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">Models</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l3"><a class="reference internal" href="services.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="variables.html">Template Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../apis/index.html">API Reference</a></li>
</ul>
</li>
</ul>

			</nav>
		</div>
	</div>

	<div class="main">
		<div class="content">
			
				<ul class="crumbs">
					<li><a href="../index.html">Plugin Development</a></li>
					<li><a href="index.html">Advanced Topics</a></li>
				</ul>
			

			
  <div class="section" id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h1>
<p>Models are containers for data. Just about every time information is passed between <a class="reference internal" href="services.html"><em>services</em></a>, <a class="reference internal" href="controllers.html"><em>controllers</em></a>, and templates in Blocks, it’s passed via a model.</p>
<p>To create a model, first create a new models/ subfolder within your plugin’s folder. Then create a new file in that folder, named with this format:</p>
<div class="highlight-python"><pre>[PluginHandle]_[ModelName]Model.php</pre>
</div>
<p>If your plugin name is “Cocktail Recipes”, and your model name is “Ingredient”, the file would be named “CocktailRecipes_IngredientModel.php”.</p>
<p>Create a new class in that file, with the same name as the filename:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">Blocks</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">CocktailRecipes_IngredientModel</span> <span class="k">extends</span> <span class="nx">BaseModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">defineAttributes</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nx">AttributeType</span><span class="o">::</span><span class="na">String</span><span class="p">,</span>
            <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="nx">AttributeType</span><span class="o">::</span><span class="na">Enum</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;alcohol,mixer,other&quot;</span><span class="p">),</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>That’s it! You will now be able to create new instances of the model, and run validation on them.</p>
<div class="section" id="instantiating-your-model">
<h2>Instantiating your Model<a class="headerlink" href="#instantiating-your-model" title="Permalink to this headline">¶</a></h2>
<p>You can create new instances of your model just like any other PHP class:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$ingredient = new CocktailRecipes_IngredientModel();</span>
<span class="x">$ingredient-&gt;name = &quot;Tonic Water&quot;;</span>
<span class="x">$ingredient-&gt;type = &quot;mixer&quot;;</span>
</pre></div>
</div>
<p>In the event that you already have an array of key/value pairs that maps to a model’s attributes, you can use the <tt class="docutils literal"><span class="pre">populateModel()</span></tt> static method instead, provided by BaseModel:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$ingredient = CocktailRecipes_IngredientModel::populateModel($data);</span>
</pre></div>
</div>
<p>There’s also a corresponding <tt class="docutils literal"><span class="pre">populateModels()</span></tt> static method if you have an array of arrays of key/value pairs:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$ingredients = CocktailRecipes_IngredientModel::populateModels($data);</span>
</pre></div>
</div>
<p>These functions also accept instances of BaseModel and <tt class="xref doc docutils literal"><span class="pre">BaseRecord</span></tt> rather than arrays.</p>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>After filling up your model instance with values, validating it is quite simple:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">if ($ingredient-&gt;validate())</span>
<span class="x">{</span>
<span class="x">    // It validates!</span>
<span class="x">}</span>
<span class="x">else</span>
<span class="x">{</span>
<span class="x">    // Here&#39;s a list of all the errors, grouped by attribute:</span>
<span class="x">    $ingredient-&gt;getErrors();</span>

<span class="x">    // Here&#39;s a list of errors for a single attribute:</span>
<span class="x">    $ingredient-&gt;getErrors(&#39;name&#39;);</span>
<span class="x">}</span>
</pre></div>
</div>
</div>
<div class="section" id="further-reading">
<h2>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p>BaseModel is an instance of Yii’s <a class="reference external" href="http://www.yiiframework.com/doc/api/1.1/CModel">CModel</a> class, so everything CModel can do, BaseModel can do as well.</p>
</div>
</div>



			
			<nav class="nav">
				Next up: <a href="controllers.html">Controllers</a></li>
			</nav>
			
		</div>
	</div>
</body>
</html>